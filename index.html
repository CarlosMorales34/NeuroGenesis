<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>ajx practices</h1>
    <ul id="users"></ul>
    <div>
        <div>
            <h2>bromas</h2>
        <button id="broma">Broma</button>
        <div id="container" style="display: none;">
            <div id="joke"></div>
        </div>
        </div>
        <div>
            <h2>Json data</h2>
            <button id="btnData">Get</button>
            <div id="output"></div>
        </div>
    </div>

<script src="https://code.jquery.com/jquery-3.6.0.js"></script>

    <script>
        $(document).ready(()=>{
            $.getJSON('https://jsonplaceholder.typicode.com/users', (data)=>{
                $.each(data, (i, user)=>{
                    $("#users").append($('<li>').text(user.name));
                })
            })

            const btn = $('#btnData');
            const output = $('#output');

            btn.on('click', ()=>{
                const postData = {
                    title: 'Una frase mamadora y fansy',
                    body: 'Este frances es un pÃ­rado',
                    userId: 1
                }
                $.ajax({
                url: 'https://jsonplaceholder.typicode.com/posts',
                type: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                data: JSON.stringify(postData),
                dataType: 'json',
                success: (post)=>{
                    const postString = JSON.stringify(post, null, 2);
                    output.text(postString);
                },
                error: (error)=>{
                    console.error(error);
                }
            })
            })

            
        })

        $.ajax({
            url: 'https://jsonplaceholder.typicode.com/posts/1',
            type: 'GET',
            dataType: 'json',
            success: (data)=>{
                let newPost = $('<div>').addClass('post');
                let title = $('h2').text(data.title);
                let body = $('<p>').text(data.body);
                newPost.append(title,body);

                $('body').append(newPost);
            },
            error: ()=>{
                console.log('Error getting data from the api');
            }
        })

        $(document).ready(()=>{
            $('#broma').click(()=>{
                $.ajax({
                    url: 'https://api.chucknorris.io/jokes/random',
                    type: 'GET',
                    dataType: 'json',
                    success: (data)=>{
                        $("#joke").html(data.value);
                        $("#container").show();
                    },
                    error: ()=>{
                        $("#joke").html('Hubo un error al conseguir la broma');
                        $("#container").hide();
                    }
                })
            })
        })
    </script>
    
</body>
</html>